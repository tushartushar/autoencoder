protected void check_thread(){
  if (Thread.currentThread() != thread)   throw new IllegalStateException("may only be called from thread " + thread.getName());
}
